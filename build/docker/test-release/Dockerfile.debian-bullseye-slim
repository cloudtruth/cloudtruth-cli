FROM debian:bullseye-slim
ARG CT_DOWNLOAD_AUTH_TOKEN=""
ARG CT_DOWNLOAD_RELEASE_ID=""
ARG CT_DOWNLOAD_VERSION=""
ENV CT_DOWNLOAD_AUTH_TOKEN=${CT_DOWNLOAD_AUTH_TOKEN}
ENV CT_DOWNLOAD_RELEASE_ID=${CT_DOWNLOAD_RELEASE_ID}
ENV CT_DOWNLOAD_VERSION=${CT_DOWNLOAD_VERSION}
RUN apt-get update
COPY ./install.sh /tmp/ctinstall.sh
RUN chmod 755 /tmp/ctinstall.sh && /tmp/ctinstall.sh \
    ${CT_DOWNLOAD_AUTH_TOKEN+--auth-token "${CT_DOWNLOAD_AUTH_TOKEN}"} \
    ${CT_DOWNLOAD_RELEASE_ID+--release-id "${CT_DOWNLOAD_RELEASE_ID}"} \
    ${CT_DOWNLOAD_VERSION+--version "${CT_DOWNLOAD_VERSION}"}
CMD cloudtruth --version